<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš´ë™ëŸ‰ ë³´ì¡´ ë²•ì¹™ ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        :root {
            --primary-color: #3b82f6; /* ë¬¼ì²´ 1 ìƒ‰ìƒ */
            --secondary-color: #ef4444; /* ë¬¼ì²´ 2 ìƒ‰ìƒ */
            --bg-color: #f8fafc;
            --panel-bg: #ffffff;
            --text-color: #334155;
            --border-color: #e2e8f0;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: var(--panel-bg);
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 { margin: 0; font-size: 1.6rem; color: #0f172a; }
        .desc { font-size: 0.95rem; color: #64748b; margin-top: 8px; }

        canvas {
            width: 100%;
            height: 250px;
            background: #ffffff;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            display: block;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
            padding: 16px;
            background: #f1f5f9;
            border-radius: 12px;
        }

        .result-box {
            background: white;
            padding: 16px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            text-align: center;
        }

        .result-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: #64748b;
            margin-bottom: 8px;
            display: block;
        }

        .result-val { font-size: 1.4rem; font-weight: 800; color: #0f172a; }
        .result-sub { font-size: 0.8rem; color: #94a3b8; margin-top: 4px; }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        button {
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }

        .btn-play { background: #10b981; color: white; }
        .btn-play:hover { background: #059669; }
        .btn-reset { background: #e2e8f0; color: #475569; }
        .btn-reset:hover { background: #cbd5e1; }

        .controls {
            margin-top: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .control-panel {
            background: #f8fafc;
            border: 1px solid var(--border-color);
            padding: 16px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .control-group { display: flex; flex-direction: column; gap: 5px; }

        label {
            font-size: 0.85rem;
            font-weight: 700;
            color: #475569;
            display: flex;
            justify-content: space-between;
        }

        input[type="range"] { width: 100%; cursor: pointer; }
        
        .badge-1 { color: var(--primary-color); font-weight: bold; }
        .badge-2 { color: var(--secondary-color); font-weight: bold; }
        .badge-sys { color: #8b5cf6; font-weight: bold; }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ’¥ 1ì°¨ì› ìš´ë™ëŸ‰ ë³´ì¡´ ë²•ì¹™ ì‹œë®¬ë ˆì´ì…˜</h1>
        <p class="desc">ë‘ ë¬¼ì²´ì˜ ì¶©ëŒ ì „í›„ ì´ ìš´ë™ëŸ‰(P)ì€ ì™¸ë ¥ì´ ì—†ë‹¤ë©´ í•­ìƒ ë³´ì¡´ë©ë‹ˆë‹¤. (P = mâ‚vâ‚ + mâ‚‚vâ‚‚)</p>
    </header>

    <canvas id="simCanvas" width="800" height="250"></canvas>

    <div class="btn-group">
        <button class="btn-play" id="btnPlay" onclick="togglePlay()">ì‹œì‘ (Play)</button>
        <button class="btn-reset" onclick="resetSim()">ì´ˆê¸°í™” (Reset)</button>
    </div>

    <div class="dashboard">
        <div class="result-box">
            <span class="result-title">ë¬¼ì²´ 1ì˜ ìš´ë™ëŸ‰ (pâ‚)</span>
            <div class="result-val" id="dispP1" style="color: var(--primary-color);">0 kgÂ·m/s</div>
            <div class="result-sub" id="dispV1">vâ‚ = 0 m/s</div>
        </div>
        <div class="result-box">
            <span class="result-title">ë¬¼ì²´ 2ì˜ ìš´ë™ëŸ‰ (pâ‚‚)</span>
            <div class="result-val" id="dispP2" style="color: var(--secondary-color);">0 kgÂ·m/s</div>
            <div class="result-sub" id="dispV2">vâ‚‚ = 0 m/s</div>
        </div>
        <div class="result-box">
            <span class="result-title">ê³„ì˜ ì´ ìš´ë™ëŸ‰ (Î£p)</span>
            <div class="result-val" id="dispPtotal" style="color: #8b5cf6;">0 kgÂ·m/s</div>
            <div class="result-sub" id="dispStatus">ì¶©ëŒ ì „ (í•­ìƒ ì¼ì •)</div>
        </div>
    </div>

    <div class="controls">
        <div class="control-panel" style="border-top: 4px solid var(--primary-color);">
            <div class="control-group">
                <label><span class="badge-1">ë¬¼ì²´ 1 ì§ˆëŸ‰ (mâ‚)</span> <span id="valM1">1.0 kg</span></label>
                <input type="range" id="inM1" min="0.5" max="5.0" step="0.5" value="1.0" oninput="updateSettings()">
            </div>
            <div class="control-group">
                <label><span class="badge-1">ë¬¼ì²´ 1 ì´ˆê¸° ì†ë„ (uâ‚)</span> <span id="valU1">4.0 m/s</span></label>
                <input type="range" id="inU1" min="-10" max="10" step="0.5" value="4.0" oninput="updateSettings()">
            </div>
        </div>

        <div class="control-panel" style="border-top: 4px solid var(--secondary-color);">
            <div class="control-group">
                <label><span class="badge-2">ë¬¼ì²´ 2 ì§ˆëŸ‰ (mâ‚‚)</span> <span id="valM2">2.0 kg</span></label>
                <input type="range" id="inM2" min="0.5" max="5.0" step="0.5" value="2.0" oninput="updateSettings()">
            </div>
            <div class="control-group">
                <label><span class="badge-2">ë¬¼ì²´ 2 ì´ˆê¸° ì†ë„ (uâ‚‚)</span> <span id="valU2">-2.0 m/s</span></label>
                <input type="range" id="inU2" min="-10" max="10" step="0.5" value="-2.0" oninput="updateSettings()">
            </div>
        </div>
        
        <div class="control-panel" style="grid-column: 1 / -1; border-top: 4px solid #8b5cf6;">
            <div class="control-group">
                <label><span class="badge-sys">ë°˜ë°œ ê³„ìˆ˜ (e)</span> <span id="valE">1.0 (ì™„ì „ íƒ„ì„± ì¶©ëŒ)</span></label>
                <input type="range" id="inE" min="0" max="1" step="0.1" value="1.0" oninput="updateSettings()">
            </div>
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById('simCanvas');
    const ctx = canvas.getContext('2d');
    
    let isPlaying = false;
    let hasCollided = false;
    let animationId;

    // ë¬¼ë¦¬ ë³€ìˆ˜
    let m1 = 1.0, m2 = 2.0;
    let u1 = 4.0, u2 = -2.0;
    let e = 1.0;
    
    // ê°ì²´ ìƒíƒœ
    let obj1 = { x: 200, v: 4.0, m: 1.0, r: 25, color: '#3b82f6' };
    let obj2 = { x: 600, v: -2.0, m: 2.0, r: 35, color: '#ef4444' };

    // DOM ìš”ì†Œ
    const btnPlay = document.getElementById('btnPlay');
    const dispP1 = document.getElementById('dispP1');
    const dispP2 = document.getElementById('dispP2');
    const dispPtotal = document.getElementById('dispPtotal');
    const dispV1 = document.getElementById('dispV1');
    const dispV2 = document.getElementById('dispV2');
    const dispStatus = document.getElementById('dispStatus');

    function updateSettings() {
        if (isPlaying) return; // ì‹¤í–‰ ì¤‘ì—ëŠ” ì„¤ì • ë³€ê²½ ë°˜ì˜ ë³´ë¥˜ (ì´ˆê¸°í™” í›„ ë°˜ì˜)
        
        m1 = parseFloat(document.getElementById('inM1').value);
        u1 = parseFloat(document.getElementById('inU1').value);
        m2 = parseFloat(document.getElementById('inM2').value);
        u2 = parseFloat(document.getElementById('inU2').value);
        e = parseFloat(document.getElementById('inE').value);

        document.getElementById('valM1').innerText = m1.toFixed(1) + " kg";
        document.getElementById('valU1').innerText = u1.toFixed(1) + " m/s";
        document.getElementById('valM2').innerText = m2.toFixed(1) + " kg";
        document.getElementById('valU2').innerText = u2.toFixed(1) + " m/s";
        
        let eStr = e.toFixed(1);
        if (e === 1.0) eStr += " (ì™„ì „ íƒ„ì„± ì¶©ëŒ)";
        else if (e === 0.0) eStr += " (ì™„ì „ ë¹„íƒ„ì„± ì¶©ëŒ)";
        else eStr += " (ë¹„íƒ„ì„± ì¶©ëŒ)";
        document.getElementById('valE').innerText = eStr;

        resetSim();
    }

    function resetSim() {
        isPlaying = false;
        hasCollided = false;
        btnPlay.innerText = "ì‹œì‘ (Play)";
        btnPlay.style.background = "#10b981";
        dispStatus.innerText = "ì¶©ëŒ ì „";
        
        // ë°˜ê²½ì€ ì§ˆëŸ‰ì— ë¹„ë¡€í•˜ì—¬ ì‹œê°ì  ì°¨ì´ ë¶€ì—¬
        obj1 = { x: 200, v: u1, m: m1, r: 20 + m1 * 4, color: '#3b82f6' };
        obj2 = { x: 600, v: u2, m: m2, r: 20 + m2 * 4, color: '#ef4444' };
        
        cancelAnimationFrame(animationId);
        updateDashboard();
        draw();
    }

    function togglePlay() {
        isPlaying = !isPlaying;
        if (isPlaying) {
            btnPlay.innerText = "ì¼ì‹œì •ì§€ (Pause)";
            btnPlay.style.background = "#f59e0b";
            loop();
        } else {
            btnPlay.innerText = "ê³„ì† (Resume)";
            btnPlay.style.background = "#10b981";
            cancelAnimationFrame(animationId);
        }
    }

    function updateDashboard() {
        const p1 = obj1.m * obj1.v;
        const p2 = obj2.m * obj2.v;
        const pTotal = p1 + p2;

        dispP1.innerText = p1.toFixed(1) + " kgÂ·m/s";
        dispP2.innerText = p2.toFixed(1) + " kgÂ·m/s";
        dispPtotal.innerText = pTotal.toFixed(1) + " kgÂ·m/s";

        dispV1.innerText = `vâ‚ = ${obj1.v.toFixed(2)} m/s`;
        dispV2.innerText = `vâ‚‚ = ${obj2.v.toFixed(2)} m/s`;
    }

    function drawArrow(x, y, v, color) {
        if (Math.abs(v) < 0.1) return; // ì†ë„ê°€ ê±°ì˜ 0ì´ë©´ í™”ì‚´í‘œ ìƒëµ
        const scale = 15; // ì†ë„ í™”ì‚´í‘œ ê¸¸ì´ ë°°ìœ¨
        const length = Math.abs(v) * scale;
        const dir = v > 0 ? 1 : -1;
        const endX = x + dir * length;
        
        ctx.strokeStyle = color;
        ctx.fillStyle = color;
        ctx.lineWidth = 3;
        
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(endX, y);
        ctx.stroke();

        // í™”ì‚´ì´‰
        ctx.beginPath();
        ctx.moveTo(endX, y);
        ctx.lineTo(endX - dir * 8, y - 6);
        ctx.lineTo(endX - dir * 8, y + 6);
        ctx.fill();
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const cy = canvas.height / 2;

        // ë°”ë‹¥ ì„ 
        ctx.strokeStyle = "#cbd5e1";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(0, cy + 40);
        ctx.lineTo(canvas.width, cy + 40);
        ctx.stroke();

        // ë¬¼ì²´ 1 (íŒŒë€ìƒ‰)
        ctx.fillStyle = obj1.color;
        ctx.beginPath();
        ctx.arc(obj1.x, cy + 40 - obj1.r, obj1.r, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = "white";
        ctx.font = "bold 14px sans-serif";
        ctx.textAlign = "center";
        ctx.fillText("mâ‚", obj1.x, cy + 45 - obj1.r);

        // ë¬¼ì²´ 2 (ë¹¨ê°„ìƒ‰)
        ctx.fillStyle = obj2.color;
        ctx.beginPath();
        ctx.arc(obj2.x, cy + 40 - obj2.r, obj2.r, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = "white";
        ctx.fillText("mâ‚‚", obj2.x, cy + 45 - obj2.r);

        // ì†ë„ í™”ì‚´í‘œ (ë¬¼ì²´ ìœ„ìª½)
        drawArrow(obj1.x, cy - 20 - obj1.r, obj1.v, obj1.color);
        drawArrow(obj2.x, cy - 20 - obj2.r, obj2.v, obj2.color);
    }

    function loop() {
        if (isPlaying) {
            // ìœ„ì¹˜ ì—…ë°ì´íŠ¸ (í™”ë©´ ìŠ¤ì¼€ì¼ì— ë§ê²Œ ì†ë„ ì¡°ì •)
            const dt = 0.5;
            obj1.x += obj1.v * dt;
            obj2.x += obj2.v * dt;

            // ì¶©ëŒ ê°ì§€ (1ì°¨ì›)
            if (!hasCollided && (obj2.x - obj1.x <= obj1.r + obj2.r)) {
                // ë‘ ë¬¼ì²´ê°€ ì„œë¡œ ê°€ê¹Œì›Œì§€ëŠ” ë°©í–¥ì¼ ë•Œë§Œ ì¶©ëŒ ì²˜ë¦¬
                if (obj1.v > obj2.v) {
                    // ì¶©ëŒ í›„ ì†ë„ ê³„ì‚° (ë°˜ë°œ ê³„ìˆ˜ e ì ìš©)
                    const v1_final = ((obj1.m - e * obj2.m) * obj1.v + obj2.m * (1 + e) * obj2.v) / (obj1.m + obj2.m);
                    const v2_final = (obj1.m * (1 + e) * obj1.v + (obj2.m - e * obj1.m) * obj2.v) / (obj1.m + obj2.m);

                    obj1.v = v1_final;
                    obj2.v = v2_final;
                    hasCollided = true;
                    
                    dispStatus.innerText = "ì¶©ëŒ ì™„ë£Œ";
                    dispStatus.style.color = "#ef4444";
                    dispStatus.style.fontWeight = "bold";
                }
            }

            // í™”ë©´ì„ ë²—ì–´ë‚˜ë©´ ì •ì§€ (ë¬´í•œ ë£¨í”„ ë°©ì§€)
            if (obj1.x < -100 || obj1.x > canvas.width + 100 || obj2.x < -100 || obj2.x > canvas.width + 100) {
                isPlaying = false;
                btnPlay.innerText = "ì‹œì‘ (Play)";
                btnPlay.style.background = "#10b981";
            }

            updateDashboard();
            draw();
            animationId = requestAnimationFrame(loop);
        }
    }

    // ì´ˆê¸°í™” ì‹¤í–‰
    updateSettings();
</script>

</body>
</html>
